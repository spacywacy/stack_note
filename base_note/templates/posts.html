{% extends "base.html" %}
{% block content%}

<!--2nd col-->
<div class="col-sm-3 d-none d-md-block bg-light sidebar">
	
		<!--search-->
		<div class="row-fluid">
			<form method="get">
				<i class="fas fa-search" aria-hidden="true"></i>
				<input class="form-control" type="text" placeholder="Search" aria-label="Search" name="search">
			</form>
		</div>

		<!--clear filter & get recent-->
		<div class="row-fluid">
			<form method="get">
				<button class="btn btn-outline-dark btn-sm" type="submit" name="clear" aria-label="Close" style="border:0px">
					<span aria-hidden="true">&times;</span>Clear All Filter
				</button>
			</form>
		</div>

		<form method="get">
			<!--filter by entry_date-->
			<div class="row-fluid" style="padding-top:2%;">
				<hr/>
				<label><i><b>Entry Date</b></i></label>
				<div class="row">
					<div class="col-2">
						<label><i>From:</i></label>
						<label><i>To:</i></label>
					</div>
					<div class="col-6">
						<div class="form-group row">
							<input class="form-control" type="date" name="sdate" value="{{ sdate }}">
							<br>
							<input class="form-control" type="date" name="edate" value="{{ edate }}">
							<br>
							<button class="btn btn-primary btn-sm" type="submit">Apply dates</button>
						</div>
					</div>
				</div>
			</div>
		</form>


		<form method="get">
			<!--filter by site-->
			<div class="row-fluid" style="padding-top:2%;">
				<hr/>
				<div class="row">
					<div class="col">
						<label><i><b>Sites</b></i></label>
					</div>
					<div class="col-1.5" style="padding-right:5%;">
						<div class="form-check">
							<input class="form-check-input" type="radio" value="name" name="sites_sort_by" onclick="this.form.submit()">
								<label class="text-muted" for="sort_by_name" style="font-size: .7em">Sort by name</label>
							</input>
						</div>
						<div class="form-check">
							<input class="form-check-input" type="radio" value="count" name="sites_sort_by" onclick="this.form.submit()">
								<label class="text-muted" for="sort_by_count" style="font-size: .7em">Sort by counts</label>
							</input>
						</div>
					</div>
				</div>
				<ul class="list-group" style="max-height:200px;overflow-y:scroll;">
				{% for item in sites %}
					<li class="list-group-item d-flex justify-content-between align-items-center {{ item.bg_color }}" style="padding-top:0px;padding-bottom:0px">
						<input class="btn text-left {{ item.text_color }}" type="submit" name="sitefilter_{{ item.name }}" id="sitefilter_{{ item.name }}" value="{{ item.name }}">
						<span class="badge badge-primary badge-pill">{{ item.count }}</span>
					</li>
				{% endfor %}
				</ul>
			</div>

			<!--filter by tag-->
			<div class="row-fluid" style="padding-top:2%;">
				<hr/>
				<div class="row">
					<div class="col">
						<label><i><b>Tags</b></i></label>
					</div>
					<div class="col-1.5" style="padding-right:5%;">
						<div class="form-check">
							<input class="form-check-input" type="radio" value="name" name="tags_sort_by" onclick="this.form.submit()">
								<label class="text-muted" for="sort_by_name" style="font-size: .7em">Sort by name</label>
							</input>
						</div>
						<div class="form-check">
							<input class="form-check-input" type="radio" value="count" name="tags_sort_by" onclick="this.form.submit()">
								<label class="text-muted" for="sort_by_count" style="font-size: .7em">Sort by counts</label>
							</input>
						</div>
					</div>
				</div>
				<ul class="list-group" style="max-height:600px;overflow-y:scroll;">
				{% for item in tags %}
					<li class="list-group-item d-flex justify-content-between align-items-center {{ item.bg_color }}" style="padding-top:0px;padding-bottom:0px">
						<input class="btn text-left {{ item.text_color }}" type="submit" name="tagfilter_{{ item.name }}" id="tagfilter_{{ item.name }}" value="{{ item.name }}">
						<span class="badge badge-primary badge-pill">{{ item.count }}</span>
					</li>
				{% endfor %}
				</ul>
			</div>


		</form>
</div>
<!--2nd col ends-->


<!--3rd col-->
<div class="col">

	<div class="row">
		<div class="col-6">
			<div class="row-fluid">
				<label class="text-muted"><small>Showing {{ n_posts }} posts</small></label>
			</div>
		</div>

		<div class="col-6">
			<form method="get">
				<button class="btn btn-outline-secondary btn-sm dropdown-toggle float-right" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Order By</button>
				<div class="dropdown-menu float-right">
					
					<div style="padding-left:10%;">
					<input type="checkbox" name="post_desc" id="post_desc">
						<label for="post_desc">Reverse</label>
					</input>
					</div>

					<div role="separator" class="dropdown-divider"></div>
					{% for item in post_fields %}
						<input class="dropdown-item" type="submit" name="postorder" value="{{ item.name }}">
					{% endfor %}
				</div>
			</form>
		</div>
	</div>


	<div class="row-fluid top-buffer">
		<div class="card" style="border: 0px">
			<form method="get">
				{% for item in selected_fields %}
					<button type="submit" class="btn btn-outline-primary btn-sm" aria-label="Close" name="clearfilter_{{ item }}" value="{{ item }}">{{ item }}<span aria-hidden="true">&times;</span></button>
				{% endfor %}
				{% if not selected_fields %}
					<button class="btn btn-outline-primary btn-sm" aria-label="Close" disabled>All Posts</button>
				{% endif %}
			</form>
		</div>
	</div>

	<div class="row-fluid">
		<ul class="list-group">


		<div id="accordion">
		{% for item in posts %}
			<!--<li class="list-group-item"><a href="{{ item.url }}" target="_blank">{{ item.title }}</a></li>-->
				
				<div class="card border-0">
					<!--card header-->
					<div class="card-header bg-white border-0" id="headingOne">
						<!--<h5 class="mb-0">-->
							<div class="row">
								<div class="col-11">
									<a href="{{ item.post.url }}" target="_blank">{{ item.post.title }}</a>
									<div class="text-muted" style="height:0em;padding-top:0%;padding-bottom:2%;font-size:.9em;">
										Date added: {{ item.post.entry_date }}
										{% if item.comment %}
											<span class="badge badge-secondary" disabled>Commented</span>
										{% endif %}
										{% if item.answers %}
											<span class="badge badge-secondary" disabled>Marked Answers</span>
										{% endif %}
									</div>
								</div>

								<div class="col-1">
									<button class="btn btn-white btn-sm float-right" data-toggle="collapse" data-target="#collapse{{forloop.counter}}" aria-expanded="true" aria-controls="collapse{{forloop.counter}}">
										<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-chevron-down" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
											<path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
										</svg>
									</button>
								</div>
							</div>
						<!--</h5>-->
					</div>
					<!--card header ends-->

					<!--card body-->
					<div id="collapse{{forloop.counter}}" class="collapse {{ item.show }}" aria-labelledby="headingOne" data-parent="#accordion" style="padding-top: 0px;">
						<div class="card-body border-0">
							<div class="row" style="padding-left:0%;">
								<div class="col">
								{% for posttag in item.posttag%}
									<span class="badge badge-secondary" disabled>{{ posttag.tag_key }}</span>
								{% endfor %}
								</div>
							</div>

							<div class="row" style="padding-top:0%;padding-left:2%;font-size:.9em;">
								<b>Question: </b>{{ item.summary }}...
							</div>

							<button
								class="btn btn-outline-secondary btn-sm border-0"
								type="button"
								style="padding-left:1%;padding-right:1%;padding-top:0%;padding-bottom:0%;"
								data-toggle="collapse"
								data-target="#answerbox"
								aria-controls="answerbox"
							>
								<svg width="1.2em" height="1.2em" viewBox="0 0 16 16" class="bi bi-plus-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg" style="padding-top:0%;padding-bottom:0%;">
									<path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
									<path fill-rule="evenodd" d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
								</svg>
								<label style="padding-top:0%;padding-bottom:0%;">Mark an answer</label>
							</button>

							<div class="row">
							<div class="col">
							<form method="post">
								{% csrf_token %}
								<div class="collapse" id="answerbox">
								<div class="input-group mb-6">
									<input class="form-control" type="url" placeholder="Add url to answer" name="answerbox_{{ item.post.id }}">
									<div class="input-group-append">
										<input class="btn btn-info btn-sm" type="submit" value="Add">
									</div>
								</div>
								</div>
							</form>
							</div>
							</div>

							{% if item.answers %}
							{% for answer in item.answers %}
							<div class="row" style="padding-left:0%;padding-left:2%;">
								<li class="list-group-item border-0" style="padding-left:0%;padding-top:2%;padding-bottom:0%;font-size:.9em;">
									<b>Marked Answer: </b>
									<a class="text-muted" href="{{ answer.marked_answer }}">
										{{ answer.marked_answer }}...
									</a>
								</li>
								<li class="list-group-item border-0" style="padding-left:0%;padding-top:0%;padding-bottom:0%;font-size:.9em;">
										{{ answer.answer_text }}...
								</li>

							</div>
							{% endfor %}
							{% endif %}

							<div class="row" style="padding-top:2%;">
							<div class="col">
								<form method="post">
									{% csrf_token %}
									{% if item.comment %}
										<b style="font-size:.9em;">My comments: </b>
									{% endif %}
									<textarea class="form-control " type="textarea" style="border:0px;font-size:.9em;" placeholder="Add some comment or notes" name="commentbox_{{ item.post.id }}" onchange="this.form.submit()" onkeydown="if(event.keyCode == 13) this.form.submit();">{{ item.comment.user_comment }}</textarea>
								</form>
							</div>
							</div>

							<hr/>

						</div>
					</div>
					<!--card body ends-->





				</div>

		{% endfor %}
		</div>

</div>
<!--3rd col ends-->














{% endblock %}
